# Полное руководство по использованию плагина Leaflet в Obsidian

## Содержание

1. [Установка плагина](#установка-плагина)
2. [Базовые функции](#базовые-функции)
3. [Расширенные возможности](#расширенные-возможности)
4. [Интеграция с другими плагинами](#интеграция-с-другими-плагинами)
5. [Настройки плагина](#настройки-плагина)
6. [Полезные советы](#полезные-советы)

## Установка плагина

1. Откройте настройки Obsidian (Settings)
2. Перейдите в раздел "Community plugins"
3. Нажмите "Browse"
4. Найдите плагин "Leaflet"
5. Установите и активируйте его

## Базовые функции

### Создание простой карты

Чтобы создать простую карту, используйте следующий код:

````markdown
```leaflet
id: my-map
image: [[путь/к/вашей/карте.png]]
```
````

Где:

- `id` - уникальное имя вашей карты
- `image` - путь к изображению карты в вашем хранилище

### Добавление маркеров

Маркеры - это точки на карте, которые можно кликнуть для получения информации:

````markdown
```leaflet
id: my-map
image: [[путь/к/вашей/карте.png]]
markers:
  - [50, 50, "Город", "Столица королевства"]
  - [30, 70, "Лес", "Зачарованный лес эльфов"]
```
````

Где:

- Первое число - координата X (от 0 до 100)
- Второе число - координата Y (от 0 до 100)
- Третье значение - название маркера
- Четвертое значение - описание (появляется при клике)

### Создание многослойных карт

Многослойные карты позволяют показывать разные типы информации:

````markdown
```leaflet
id: my-map
image: [[путь/к/вашей/карте.png]]
layers:
  - name: Города
    markers:
      - [50, 50, "Столица", "Главный город"]
  - name: Достопримечательности
    markers:
      - [30, 30, "Замок", "Древний замок"]
```
````

### Добавление зон

Зоны - это области на карте, которые можно выделить:

````markdown
```leaflet
id: my-map
image: [[путь/к/вашей/карте.png]]
zones:
  - name: Королевство
    color: "#ff0000"
    points: [[10,10], [90,10], [90,90], [10,90]]
```
````

Где:

- `name` - название зоны
- `color` - цвет зоны (в формате HEX)
- `points` - координаты углов зоны

## Расширенные возможности

### Автоматическое создание маркеров из заметок

Вы можете автоматически создавать маркеры из заметок, используя следующие параметры:

````markdown
```leaflet
id: my-map
image: [[путь/к/вашей/карте.png]]
markerFile: [[Путь/к/заметке.md]]
markerFolder: Папка/с/заметками
markerTag: #локация, #город
```
````

### Измерение расстояний

- Удерживайте Shift или Alt и кликните по карте или маркеру
- Кликните в другое место
- Расстояние между точками будет отображено в метрах
- В нижнем левом углу появится контрольная панель с последним измеренным расстоянием

### Темный режим

Добавьте параметр `darkMode` для инвертирования цветов карты:

````markdown
```leaflet
id: my-map
image: [[путь/к/вашей/карте.png]]
darkMode: true
```
````

### Пользовательские маркеры

Вы можете создавать собственные типы маркеров:

1. В настройках плагина нажмите "Добавить маркер"
2. Заполните параметры:
   - Название маркера
   - Иконка (Font Awesome)
   - Загрузка изображения
   - Настройка слоя
   - Цвет иконки
   - Связанные теги

### Локальные типы маркеров

Создайте файл `markers.json` в нужной папке для определения локальных типов маркеров:

```json
[
  {
    "name": "Город",
    "icon": "city",
    "color": "#ff0000"
  }
]
```

## Интеграция с другими плагинами

### Initiative Tracker

Если установлен плагин Initiative Tracker:

- Карта боя может быть открыта из представления Initiative Tracker
- Активные существа автоматически загружаются как маркеры
- Можно установить типы маркеров по умолчанию для PC и NPC
- Состояние карты синхронизируется с Initiative Tracker

## Настройки плагина

### Экспорт маркеров в CSV

Маркеры можно экспортировать в CSV файл со следующими колонками:

- ID карты
- Тип маркера
- Широта
- Долгота
- Ссылка на маркер
- Слой маркера
- ID маркера

### Дополнительные настройки

1. **Поведение подсказок маркеров по умолчанию**

   - Настройка отображения подсказок при наведении

2. **Режим рисования по умолчанию**

   - Включение/выключение инструментов рисования

3. **Предпросмотр заметок**

   - Отображение предпросмотра заметок при наведении на маркер
   - Требует включенного плагина Page Preview

4. **Отображение подсказок наложения**

   - Управление отображением подсказок для наложений

5. **Копирование координат**
   - Копирование координат в буфер обмена при Shift+клике

## Полезные советы

1. **Подготовка карт**

   - Используйте изображения высокого качества
   - Оптимальный размер: 2000-4000 пикселей
   - Поддерживаемые форматы: PNG, JPG, WebP

2. **Организация**

   - Создайте отдельную папку для карт
   - Используйте теги для быстрого поиска
   - Храните связанные заметки рядом с картами

3. **Производительность**

   - Используйте оптимизированные изображения
   - Ограничьте количество маркеров на одной карте
   - Используйте слои для организации информации

4. **Безопасность**
   - Регулярно делайте резервные копии
   - Тестируйте новые функции на копиях карт
   - Сохраняйте исходные файлы изображений
